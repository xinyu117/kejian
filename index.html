<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èœ—ç‰›çˆ¬æ ‘åŠ¨ç”»æ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #87CEEB 0%, #98FB98 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
            max-width: 800px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .problem-description {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #3498db;
        }

        .animation-area {
            position: relative;
            width: 100%;
            height: 500px;
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 30px;
            transition: background 1s ease-in-out;
        }

        .animation-area.day-bg {
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
        }

        .animation-area.night-bg {
            background: linear-gradient(to bottom, #191970 0%, #2F4F4F 100%);
        }

        .tree {
            position: absolute;
            left: 50%;
            bottom: 0;
            transform: translateX(-50%);
            width: 60px;
            height: 450px;
            background: linear-gradient(to right, #8B4513, #A0522D);
            border-radius: 30px 30px 0 0;
            transition: all 0.5s ease;
        }

        .tree::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #228B22, #32CD32);
            border-radius: 50%;
            transition: all 0.5s ease;
        }

        .night-bg .tree {
            background: linear-gradient(to right, #654321, #8B4513);
        }

        .night-bg .tree::before {
            background: radial-gradient(circle, #006400, #228B22);
        }

        .height-markers {
            position: absolute;
            left: calc(50% - 120px);
            bottom: 0;
            height: 450px;
        }

        .height-marker {
            position: absolute;
            width: 40px;
            height: 2px;
            background: #666;
            left: 0;
        }

        .height-label {
            position: absolute;
            left: -30px;
            top: -10px;
            font-size: 14px;
            color: #333;
            font-weight: bold;
            transition: color 0.5s ease;
        }

        .night-bg .height-label {
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        .snail {
            position: absolute;
            left: calc(50% + 35px);
            bottom: 0;
            width: 40px;
            height: 30px;
            transition: bottom 0.5s ease-in-out;
            /* èœ—ç‰›åº•éƒ¨å¯¹é½åˆ»åº¦çº¿ */
        }

        .snail-body {
            width: 100%;
            height: 100%;
            background: #DEB887;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            position: relative;
            transition: all 0.5s ease;
        }

        .night-bg .snail-body {
            box-shadow: 0 0 10px rgba(222, 184, 135, 0.8);
        }

        .snail-shell {
            position: absolute;
            top: -5px;
            right: 5px;
            width: 25px;
            height: 25px;
            background: radial-gradient(circle, #8B4513, #D2691E);
            border-radius: 50%;
            border: 2px solid #654321;
        }

        .snail-shell::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 15px;
            height: 15px;
            background: #654321;
            border-radius: 50%;
        }

        .snail-eyes {
            position: absolute;
            top: 5px;
            left: 5px;
        }

        .snail-eye {
            width: 3px;
            height: 8px;
            background: #333;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            display: inline-block;
            margin-right: 2px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }

        .status {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 20px;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #ecf0f1;
            border-radius: 10px;
            padding: 15px;
        }

        .progress {
            background: #ecf0f1;
            border-radius: 10px;
            padding: 20px;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .day-night-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            transition: all 0.5s ease;
        }

        .day {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }

        .night {
            background: linear-gradient(45deg, #191970, #000080);
            box-shadow: 0 0 20px rgba(25, 25, 112, 0.6);
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .snail.climbing {
            animation: bounce 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ èœ—ç‰›çˆ¬æ ‘åŠ¨ç”»æ¼”ç¤º</h1>
        
        <div class="problem-description">
            <h3>é—®é¢˜æè¿°ï¼š</h3>
            <p>èœ—ç‰›çˆ¬æ ‘ï¼Œæ ‘é«˜ <strong>9ç±³</strong>ï¼Œèœ—ç‰›ç™½å¤©çˆ¬ <strong>3ç±³</strong>ï¼Œæ™šä¸Šæ»‘è½ <strong>1ç±³</strong>ï¼Œé—®å‡ å¤©èƒ½çˆ¬åˆ°æ ‘é¡¶ï¼Ÿ</p>
        </div>

        <div class="animation-area day-bg">
            <div class="day-night-indicator day" id="dayNightIndicator">â˜€ï¸</div>
            
            <div class="height-markers" id="heightMarkers"></div>
            
            <div class="tree"></div>
            
            <div class="snail" id="snail">
                <div class="snail-body">
                    <div class="snail-shell"></div>
                    <div class="snail-eyes">
                        <div class="snail-eye"></div>
                        <div class="snail-eye"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="startAnimation()">å¼€å§‹æ¼”ç¤º</button>
            <button class="btn btn-secondary" onclick="resetAnimation()">é‡ç½®</button>
        </div>

        <div class="status" id="status">
            ç‚¹å‡»"å¼€å§‹æ¼”ç¤º"æŸ¥çœ‹èœ—ç‰›çˆ¬æ ‘è¿‡ç¨‹
        </div>

        <div class="progress" id="progress">
            <div class="progress-item">
                <span>å½“å‰å¤©æ•°ï¼š</span>
                <span id="currentDay">0</span>
            </div>
            <div class="progress-item">
                <span>å½“å‰é«˜åº¦ï¼š</span>
                <span id="currentHeight">0ç±³</span>
            </div>
            <div class="progress-item">
                <span>ç™½å¤©çˆ¬å‡ï¼š</span>
                <span id="dayClimb">0ç±³</span>
            </div>
            <div class="progress-item">
                <span>å¤œé—´æ»‘è½ï¼š</span>
                <span id="nightFall">0ç±³</span>
            </div>
        </div>

        <div class="solution-section" style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #28a745;">
            <h3 style="color: #28a745; margin-bottom: 15px;">ğŸ“š è§£é¢˜æ€è·¯ä¸è®¡ç®—æ–¹æ³•</h3>
            
            <div style="margin-bottom: 15px;">
                <h4 style="color: #2c3e50; margin-bottom: 10px;">ğŸ” å…³é”®ç†è§£ç‚¹ï¼š</h4>
                <ul style="margin-left: 20px; line-height: 1.6;">
                    <li><strong>ä¸´ç•Œæ¡ä»¶</strong>ï¼šå½“èœ—ç‰›ç™½å¤©çˆ¬åˆ°æˆ–è¶…è¿‡æ ‘é¡¶æ—¶ï¼Œå°±ä¸ä¼šå†æ»‘è½</li>
                    <li><strong>å‡€è¿›å±•</strong>ï¼šé™¤äº†æœ€åä¸€å¤©ï¼Œæ¯å¤©çš„å‡€è¿›å±• = ç™½å¤©çˆ¬å‡ - å¤œæ™šæ»‘è½</li>
                    <li><strong>æœ€åä¸€å¤©</strong>ï¼šåªéœ€è€ƒè™‘ç™½å¤©çš„çˆ¬å‡ï¼Œä¸ä¼šå†æ»‘è½</li>
                </ul>
            </div>

            <div style="margin-bottom: 15px;">
                <h4 style="color: #2c3e50; margin-bottom: 10px;">ğŸ“ é€šç”¨è®¡ç®—å…¬å¼ï¼š</h4>
                <div style="background: #e9ecef; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace;">
                    <p><strong>è®¾ï¼š</strong></p>
                    <p>â€¢ H = æ ‘é«˜ï¼ˆç±³ï¼‰</p>
                    <p>â€¢ D = ç™½å¤©çˆ¬å‡è·ç¦»ï¼ˆç±³ï¼‰</p>
                    <p>â€¢ N = å¤œæ™šæ»‘è½è·ç¦»ï¼ˆç±³ï¼‰</p>
                    <p>â€¢ å‡€è¿›å±• = D - Nï¼ˆç±³/å¤©ï¼‰</p>
                    <br>
                    <p><strong>è®¡ç®—æ­¥éª¤ï¼š</strong></p>
                    <p>1. æœ€åä¸€å¤©éœ€è¦çˆ¬å‡çš„è·ç¦» = D</p>
                    <p>2. å‰é¢å‡ å¤©éœ€è¦çˆ¬å‡çš„æ€»è·ç¦» = H - D</p>
                    <p>3. éœ€è¦çš„å¤©æ•° = âŒˆ(H - D) Ã· (D - N)âŒ‰ + 1</p>
                    <p style="color: #6c757d;">ï¼ˆâŒˆâŒ‰è¡¨ç¤ºå‘ä¸Šå–æ•´ï¼‰</p>
                </div>
            </div>

            <div style="margin-bottom: 15px;">
                <h4 style="color: #2c3e50; margin-bottom: 10px;">ğŸ’¡ æœ¬é¢˜è®¡ç®—è¿‡ç¨‹ï¼š</h4>
                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 3px solid #ffc107;">
                    <p><strong>å·²çŸ¥ï¼š</strong>H = 9ç±³ï¼ŒD = 3ç±³ï¼ŒN = 1ç±³</p>
                    <br>
                    <p><strong>æ–¹æ³•ä¸€ï¼šé€å¤©è®¡ç®—</strong></p>
                    <ul style="margin-left: 20px;">
                        <li>ç¬¬1å¤©ï¼š0â†’3ç±³ï¼Œå¤œæ™š3â†’2ç±³</li>
                        <li>ç¬¬2å¤©ï¼š2â†’5ç±³ï¼Œå¤œæ™š5â†’4ç±³</li>
                        <li>ç¬¬3å¤©ï¼š4â†’7ç±³ï¼Œå¤œæ™š7â†’6ç±³</li>
                        <li>ç¬¬4å¤©ï¼š6â†’9ç±³ï¼Œ<span style="color: #28a745; font-weight: bold;">åˆ°è¾¾æ ‘é¡¶ï¼</span></li>
                    </ul>
                    <br>
                    <p><strong>æ–¹æ³•äºŒï¼šå…¬å¼è®¡ç®—</strong></p>
                    <p>â€¢ å‡€è¿›å±• = 3 - 1 = 2ç±³/å¤©</p>
                    <p>â€¢ æœ€åä¸€å¤©å‰éœ€çˆ¬ï¼š9 - 3 = 6ç±³</p>
                    <p>â€¢ éœ€è¦å¤©æ•°ï¼šâŒˆ6 Ã· 2âŒ‰ + 1 = 3 + 1 = <span style="color: #28a745; font-weight: bold;">4å¤©</span></p>
                </div>
            </div>

            <div>
                <h4 style="color: #2c3e50; margin-bottom: 10px;">ğŸ¯ è§£é¢˜è¦ç‚¹æ€»ç»“ï¼š</h4>
                <div style="background: #d1ecf1; padding: 15px; border-radius: 8px; border-left: 3px solid #17a2b8;">
                    <ol style="margin-left: 20px; line-height: 1.6;">
                        <li><strong>è¯†åˆ«ä¸´ç•Œæ¡ä»¶</strong>ï¼šåˆ°è¾¾æ ‘é¡¶å°±ä¸å†æ»‘è½</li>
                        <li><strong>åˆ†ç¦»æœ€åä¸€å¤©</strong>ï¼šæœ€åä¸€å¤©åªéœ€è€ƒè™‘ç™½å¤©çˆ¬å‡</li>
                        <li><strong>è®¡ç®—å‡€è¿›å±•</strong>ï¼šå‰é¢æ¯å¤©çš„å®é™…è¿›å±•</li>
                        <li><strong>åº”ç”¨å…¬å¼</strong>ï¼šé¿å…é€å¤©æšä¸¾çš„ç¹ç</li>
                        <li><strong>éªŒè¯ç»“æœ</strong>ï¼šå¯ç”¨é€å¤©è®¡ç®—éªŒè¯å…¬å¼ç»“æœ</li>
                    </ol>
                </div>
            </div>
        </div>

        <div class="practice-section" style="background: #f0f8ff; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #6f42c1;">
            <h3 style="color: #6f42c1; margin-bottom: 15px;">ğŸ§® ä¸¾ä¸€åä¸‰ - å˜å¼ç»ƒä¹ </h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h5 style="color: #6f42c1; margin-bottom: 10px;">ç»ƒä¹ 1</h5>
                    <p style="font-size: 14px; margin-bottom: 8px;">æ ‘é«˜12ç±³ï¼Œç™½å¤©çˆ¬4ç±³ï¼Œå¤œæ™šæ»‘2ç±³</p>
                    <details style="margin-top: 8px;">
                        <summary style="cursor: pointer; color: #6f42c1;">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</summary>
                        <div style="margin-top: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px;">
                            <p>å‡€è¿›å±• = 4 - 2 = 2ç±³/å¤©</p>
                            <p>æœ€åä¸€å¤©å‰éœ€çˆ¬ï¼š12 - 4 = 8ç±³</p>
                            <p>å¤©æ•°ï¼šâŒˆ8 Ã· 2âŒ‰ + 1 = 4 + 1 = <strong>5å¤©</strong></p>
                        </div>
                    </details>
                </div>
                
                <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h5 style="color: #6f42c1; margin-bottom: 10px;">ç»ƒä¹ 2</h5>
                    <p style="font-size: 14px; margin-bottom: 8px;">æ ‘é«˜15ç±³ï¼Œç™½å¤©çˆ¬5ç±³ï¼Œå¤œæ™šæ»‘3ç±³</p>
                    <details style="margin-top: 8px;">
                        <summary style="cursor: pointer; color: #6f42c1;">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</summary>
                        <div style="margin-top: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px;">
                            <p>å‡€è¿›å±• = 5 - 3 = 2ç±³/å¤©</p>
                            <p>æœ€åä¸€å¤©å‰éœ€çˆ¬ï¼š15 - 5 = 10ç±³</p>
                            <p>å¤©æ•°ï¼šâŒˆ10 Ã· 2âŒ‰ + 1 = 5 + 1 = <strong>6å¤©</strong></p>
                        </div>
                    </details>
                </div>
            </div>

            <div style="background: #e6f3ff; padding: 15px; border-radius: 8px; border-left: 3px solid #007bff;">
                <h5 style="color: #007bff; margin-bottom: 10px;">ğŸ¤” æ€è€ƒé¢˜ï¼šç‰¹æ®Šæƒ…å†µ</h5>
                <p style="margin-bottom: 10px;"><strong>æƒ…å†µ1ï¼š</strong>å¦‚æœç™½å¤©çˆ¬å‡è·ç¦» â‰¥ æ ‘é«˜ï¼Œç­”æ¡ˆæ˜¯å¤šå°‘ï¼Ÿ</p>
                <p style="margin-bottom: 10px;"><strong>æƒ…å†µ2ï¼š</strong>å¦‚æœç™½å¤©çˆ¬å‡ â‰¤ å¤œæ™šæ»‘è½ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
                <details style="margin-top: 10px;">
                    <summary style="cursor: pointer; color: #007bff;">ç‚¹å‡»æŸ¥çœ‹åˆ†æ</summary>
                    <div style="margin-top: 10px; padding: 10px; background: white; border-radius: 4px;">
                        <p><strong>æƒ…å†µ1ï¼š</strong>å¦‚æœD â‰¥ Hï¼Œç¬¬ä¸€å¤©å°±èƒ½çˆ¬åˆ°æ ‘é¡¶ï¼Œç­”æ¡ˆæ˜¯ <strong>1å¤©</strong></p>
                        <p><strong>æƒ…å†µ2ï¼š</strong>å¦‚æœD â‰¤ Nï¼Œèœ—ç‰›æ°¸è¿œæ— æ³•çˆ¬åˆ°æ ‘é¡¶ï¼ˆå‡€è¿›å±•â‰¤0ï¼‰</p>
                        <p style="color: #6c757d; font-style: italic;">è¿™æé†’æˆ‘ä»¬åœ¨è§£é¢˜å‰è¦å…ˆåˆ¤æ–­é—®é¢˜æ˜¯å¦æœ‰è§£ï¼</p>
                    </div>
                </details>
            </div>
        </div>
    </div>

    <script>
        let currentHeight = 0;
        let currentDay = 0;
        let isAnimating = false;
        let animationTimeout;

        const TREE_HEIGHT = 9;
        const DAY_CLIMB = 3;
        const NIGHT_FALL = 1;
        const ANIMATION_HEIGHT = 450; // åŠ¨ç”»åŒºåŸŸçš„åƒç´ é«˜åº¦

        function initializeHeightMarkers() {
            const markersContainer = document.getElementById('heightMarkers');
            markersContainer.innerHTML = '';
            
            for (let i = 0; i <= TREE_HEIGHT; i++) {
                const marker = document.createElement('div');
                marker.className = 'height-marker';
                marker.style.bottom = `${(i / TREE_HEIGHT) * ANIMATION_HEIGHT}px`;
                
                const label = document.createElement('div');
                label.className = 'height-label';
                label.textContent = `${i}m`;
                marker.appendChild(label);
                
                markersContainer.appendChild(marker);
            }
        }

        function updateSnailPosition() {
            const snail = document.getElementById('snail');
            // è®¡ç®—åƒç´ é«˜åº¦ï¼Œèœ—ç‰›åº•éƒ¨å¯¹é½åˆ»åº¦çº¿
            const pixelHeight = (currentHeight / TREE_HEIGHT) * ANIMATION_HEIGHT;
            console.log(`æ›´æ–°èœ—ç‰›ä½ç½®ï¼š${currentHeight}ç±³ -> ${pixelHeight}px (åº•éƒ¨å¯¹é½)`);
            snail.style.bottom = `${pixelHeight}px`;
        }

        function updateStatus(message) {
            document.getElementById('status').textContent = message;
        }

        function updateProgress() {
            document.getElementById('currentDay').textContent = currentDay;
            document.getElementById('currentHeight').textContent = `${currentHeight}ç±³`;
        }

        function updateDayNightIndicator(isDay) {
            const indicator = document.getElementById('dayNightIndicator');
            const animationArea = document.querySelector('.animation-area');
            
            if (isDay) {
                indicator.className = 'day-night-indicator day';
                indicator.textContent = 'â˜€ï¸';
                animationArea.className = 'animation-area day-bg';
            } else {
                indicator.className = 'day-night-indicator night';
                indicator.textContent = 'ğŸŒ™';
                animationArea.className = 'animation-area night-bg';
            }
        }

        async function animateClimb(targetHeight, duration = 1000) {
            return new Promise(resolve => {
                const snail = document.getElementById('snail');
                snail.classList.add('climbing');
                
                setTimeout(() => {
                    currentHeight = targetHeight;
                    updateSnailPosition();
                    updateProgress();
                    snail.classList.remove('climbing');
                    resolve();
                }, duration);
            });
        }

        async function simulateDay() {
            updateDayNightIndicator(true);
            updateStatus(`ç¬¬${currentDay}å¤©ç™½å¤©ï¼šèœ—ç‰›å¼€å§‹çˆ¬å‡...`);
            
            document.getElementById('dayClimb').textContent = `+${DAY_CLIMB}ç±³`;
            document.getElementById('nightFall').textContent = '0ç±³';
            
            const newHeight = Math.min(currentHeight + DAY_CLIMB, TREE_HEIGHT);
            await animateClimb(newHeight, 1500);
            
            if (currentHeight >= TREE_HEIGHT) {
                updateStatus(`ğŸ‰ æ­å–œï¼èœ—ç‰›åœ¨ç¬¬${currentDay}å¤©æˆåŠŸçˆ¬åˆ°äº†æ ‘é¡¶ï¼`);
                return true; // åˆ°è¾¾æ ‘é¡¶
            }
            
            updateStatus(`ç¬¬${currentDay}å¤©ç™½å¤©ç»“æŸï¼Œèœ—ç‰›çˆ¬åˆ°äº†${currentHeight}ç±³`);
            return false;
        }

        async function simulateNight() {
            if (currentHeight >= TREE_HEIGHT) return;
            
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            updateDayNightIndicator(false);
            updateStatus(`ç¬¬${currentDay}å¤©å¤œæ™šï¼šèœ—ç‰›å¼€å§‹æ»‘è½...`);
            
            document.getElementById('nightFall').textContent = `-${NIGHT_FALL}ç±³`;
            
            const newHeight = Math.max(currentHeight - NIGHT_FALL, 0);
            await animateClimb(newHeight, 1000);
            
            updateStatus(`ç¬¬${currentDay}å¤©å¤œæ™šç»“æŸï¼Œèœ—ç‰›æ»‘è½åˆ°${currentHeight}ç±³`);
        }

        async function startAnimation() {
            if (isAnimating) return;
            
            console.log('å¼€å§‹åŠ¨ç”»');
            isAnimating = true;
            const startBtn = document.querySelector('.btn-primary');
            startBtn.disabled = true;
            startBtn.textContent = 'æ¼”ç¤ºä¸­...';
            
            // é‡ç½®çŠ¶æ€ä½†ä¸è°ƒç”¨resetAnimationï¼Œé¿å…é‡å¤è®¾ç½®
            currentHeight = 0;
            currentDay = 0;
            updateSnailPosition();
            updateProgress();
            updateDayNightIndicator(true);
            updateStatus('åŠ¨ç”»å¼€å§‹...');
            document.getElementById('dayClimb').textContent = '0ç±³';
            document.getElementById('nightFall').textContent = '0ç±³';
            
            // ç»™ä¸€ä¸ªå°å»¶è¿Ÿè®©ç”¨æˆ·çœ‹åˆ°åˆå§‹çŠ¶æ€
            await new Promise(resolve => setTimeout(resolve, 500));
            
            while (currentHeight < TREE_HEIGHT && isAnimating) {
                currentDay++;
                console.log(`å¼€å§‹ç¬¬${currentDay}å¤©ï¼Œå½“å‰é«˜åº¦ï¼š${currentHeight}ç±³`);
                
                // ç™½å¤©çˆ¬å‡
                const reachedTop = await simulateDay();
                if (reachedTop) break;
                
                // å¤œæ™šæ»‘è½
                await simulateNight();
                
                // ç­‰å¾…ä¸€ä¸‹å†è¿›è¡Œä¸‹ä¸€å¤©
                await new Promise(resolve => setTimeout(resolve, 1500));
            }
            
            isAnimating = false;
            startBtn.disabled = false;
            startBtn.textContent = 'å¼€å§‹æ¼”ç¤º';
            
            // æ˜¾ç¤ºæœ€ç»ˆç­”æ¡ˆ
            setTimeout(() => {
                updateStatus(`ğŸ“Š ç­”æ¡ˆï¼šèœ—ç‰›éœ€è¦${currentDay}å¤©æ‰èƒ½çˆ¬åˆ°æ ‘é¡¶ï¼`);
            }, 2000);
        }

        function resetAnimation() {
            if (animationTimeout) {
                clearTimeout(animationTimeout);
            }
            
            isAnimating = false;
            currentHeight = 0;
            currentDay = 0;
            
            updateSnailPosition();
            updateProgress();
            updateDayNightIndicator(true); // è¿™ä¼šåŒæ—¶é‡ç½®èƒŒæ™¯ä¸ºç™½å¤©æ¨¡å¼
            updateStatus('ç‚¹å‡»"å¼€å§‹æ¼”ç¤º"æŸ¥çœ‹èœ—ç‰›çˆ¬æ ‘è¿‡ç¨‹');
            
            document.getElementById('dayClimb').textContent = '0ç±³';
            document.getElementById('nightFall').textContent = '0ç±³';
            
            const startBtn = document.querySelector('.btn-primary');
            startBtn.disabled = false;
            startBtn.textContent = 'å¼€å§‹æ¼”ç¤º';
        }

        // åˆå§‹åŒ–
        window.addEventListener('load', () => {
            initializeHeightMarkers();
            resetAnimation();
        });
    </script>
</body>
</html> 